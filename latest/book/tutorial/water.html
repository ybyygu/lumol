<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Molecular dynamics simulation of water &#8212; Lumol 0.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/lumol.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lumol concepts" href="../concepts/index.html" />
    <link rel="prev" title="Hello Sodium Chloride" href="nacl.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Lumol</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Navigation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Lumol concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">Input file reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Modifying lumol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="nacl.html" title="Previous Chapter: Hello Sodium Chloride"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Hello Sodium Chloride</span>
    </a>
  </li>
  <li>
    <a href="../concepts/index.html" title="Next Chapter: Lumol concepts"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Lumol concepts &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="argon.html">Monte Carlo simulation of Argon</a></li>
<li class="toctree-l2"><a class="reference internal" href="nacl.html">Hello Sodium Chloride</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Molecular dynamics simulation of water</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Lumol concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">Input file reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Modifying lumol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="molecular-dynamics-simulation-of-water">
<h1>Molecular dynamics simulation of water<a class="headerlink" href="#molecular-dynamics-simulation-of-water" title="Permalink to this headline">¶</a></h1>
<p>In this example, we will simulate a molecular liquid of high scientific
interest: water. At the same time we will learn how we can reuse a potential
definition between multiple simulations, and how we can switch the potential
definition in a simulation.</p>
<p>You will need three input files for this simulation:</p>
<ul class="simple">
<li>the initial configuration <code class="docutils literal notranslate"><span class="pre">water.xyz</span></code>;</li>
<li>the simulation input <code class="docutils literal notranslate"><span class="pre">water.toml</span></code>;</li>
<li>the force field (potential definitions) <code class="docutils literal notranslate"><span class="pre">water-fSCP.toml</span></code>.</li>
</ul>
<p>You can download them <a class="reference download internal" href="../_downloads/water.zip" download=""><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
<p>As usual, you can run the simulation with <code class="docutils literal notranslate"><span class="pre">lumol</span> <span class="pre">water.toml</span></code>. The simulation
should finish in a few minutes.</p>
<div class="section" id="the-input-files-commented">
<h2>The input files commented<a class="headerlink" href="#the-input-files-commented" title="Permalink to this headline">¶</a></h2>
<div class="section" id="water-toml-file">
<h3><code class="docutils literal notranslate"><span class="pre">water.toml</span></code> file<a class="headerlink" href="#water-toml-file" title="Permalink to this headline">¶</a></h3>
<p>The main input file is pretty similar to the previous examples, with two
novelties:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">guess_bonds</span> <span class="pre">=</span> <span class="pre">true</span></code> entry tells Lumol to try to guess the bonds from
the distances in the XYZ file. This is needed because we want to simulate a
molecule but there is no bonding information inside the XYZ format. If we
were to use a PDB file with connectivity instead, this would not be needed;</li>
<li>The <code class="docutils literal notranslate"><span class="pre">potentials</span> <span class="pre">=</span> <span class="pre">&quot;water-fSCP.toml&quot;</span></code> tells Lumol to read the potentials
from the <code class="docutils literal notranslate"><span class="pre">water-fSCP.toml</span></code> file. Using this type of input for the
potentials we can reuse the same potential for multiple simulations and also
easily change the potential used in the simulation.</li>
</ul>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">input</span><span class="p">]</span>
<span class="n">version</span> <span class="o">=</span> <span class="mi">1</span>

<span class="p">[[</span><span class="n">systems</span><span class="p">]]</span>
<span class="n">file</span> <span class="o">=</span> <span class="s">&quot;water.xyz&quot;</span>
<span class="n">guess_bonds</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">cell</span> <span class="o">=</span> <span class="mf">28.0</span>
<span class="n">potentials</span> <span class="o">=</span> <span class="s">&quot;water-fSCP.toml&quot;</span>

<span class="p">[[</span><span class="n">simulations</span><span class="p">]]</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Trajectory&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&quot;trajectory.xyz&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">]</span>

<span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="water-fscp-toml-file">
<h3><code class="docutils literal notranslate"><span class="pre">water-fSCP.toml</span></code> file<a class="headerlink" href="#water-fscp-toml-file" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">water-fSCP.toml</span></code> is a standalone potential input file. It contains the same
data as a potential definition inside a <code class="docutils literal notranslate"><span class="pre">[[systems]]</span></code> section, but without the
<code class="docutils literal notranslate"><span class="pre">system.potential</span></code> prefix on all section names.</p>
<p>In this input, we start by defining which version of the input format we are
using.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">input</span><span class="p">]</span>
<span class="n">version</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Then, we can define some global input data: the pair potential cutoff and the
atomic charges.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">global</span><span class="p">]</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="s">&quot;14 A&quot;</span>

<span class="p">[</span><span class="n">charges</span><span class="p">]</span>
<span class="n">O</span> <span class="o">=</span> <span class="mi">-0</span><span class="mf">.82</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">0.41</span>
</pre></div>
</div>
<p>The pair potential section contains the usual declarations for pairs, with a few
additional options.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">pairs</span><span class="p">]]</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;O&quot;</span><span class="p">,</span> <span class="s">&quot;O&quot;</span><span class="p">]</span>
<span class="n">lj</span> <span class="o">=</span> <span class="p">{</span><span class="n">sigma</span> <span class="o">=</span> <span class="s">&quot;3.16 A&quot;</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="s">&quot;0.155 kcal/mol&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>We can add a <code class="docutils literal notranslate"><span class="pre">restriction</span></code> to restrict a specific pair interaction to some
kind of pairs. Here, we will only account for H-H pairs inside the same molecule
(<code class="docutils literal notranslate"><span class="pre">&quot;intra-molecular&quot;</span></code> interactions).</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">pairs</span><span class="p">]]</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;H&quot;</span><span class="p">,</span> <span class="s">&quot;H&quot;</span><span class="p">]</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="o">=</span> <span class="s">&quot;79.8 kcal/mol/A^2&quot;</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="s">&quot;1.633 A&quot;</span><span class="p">}</span>
<span class="n">restriction</span> <span class="o">=</span> <span class="s">&quot;intra-molecular&quot;</span>
</pre></div>
</div>
<p>We can also define a non-interacting pair interaction! This is useful when some
atoms do not interact in the model we use.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">pairs</span><span class="p">]]</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;H&quot;</span><span class="p">,</span> <span class="s">&quot;O&quot;</span><span class="p">]</span>
<span class="n">null</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
<p>Next, the bonds and angles are defined. These are interactions used
between bonded particles (or angles formed by two bonds and dihedral angles
formed by three bonds). This section follows the same pattern as the
<code class="docutils literal notranslate"><span class="pre">[[pairs]]</span></code> section.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">bonds</span><span class="p">]]</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;O&quot;</span><span class="p">,</span> <span class="s">&quot;H&quot;</span><span class="p">]</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="o">=</span> <span class="s">&quot;1054.2 kcal/mol/A^2&quot;</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="s">&quot;1.0 A&quot;</span><span class="p">}</span>

<span class="p">[[</span><span class="n">angles</span><span class="p">]]</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;H&quot;</span><span class="p">,</span> <span class="s">&quot;O&quot;</span><span class="p">,</span> <span class="s">&quot;H&quot;</span><span class="p">]</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="o">=</span> <span class="s">&quot;75.9 kcal/mol/rad^2&quot;</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="s">&quot;109.5 deg&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Finally we specify how to compute the electrostatic interaction, this time using
the Ewald summation method. We can restrict the coulombic interactions to only
apply between particles not in the same molecule by using
<code class="docutils literal notranslate"><span class="pre">restriction</span> <span class="pre">=</span> <span class="pre">&quot;inter-molecular&quot;</span></code>.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">coulomb</span><span class="p">]</span>
<span class="n">ewald</span> <span class="o">=</span> <span class="p">{</span><span class="n">cutoff</span> <span class="o">=</span> <span class="s">&quot;8.5 A&quot;</span><span class="p">,</span> <span class="n">kmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">restriction</span> <span class="o">=</span> <span class="s">&quot;inter-molecular&quot;</span>
</pre></div>
</div>
<p>The simulation is run via</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">lumol</span> <span class="n">water</span><span class="p">.</span><span class="n">toml</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p class="pull-left">
        &copy; Lumol contributors
    </p>
    <p class="text-center">
        Available on <a href="https://github.com/lumol-org/lumol">Github</a>
    </p>
  </div>
</footer>

  </body>
</html>