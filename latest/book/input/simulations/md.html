<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Molecular dynamics &#8212; Lumol 0.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/lumol.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Monte Carlo" href="mc.html" />
    <link rel="prev" title="Minimization" href="min.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          Lumol</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Navigation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">Lumol concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Input file reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/index.html">Modifying lumol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="min.html" title="Previous Chapter: Minimization"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Minimization</span>
    </a>
  </li>
  <li>
    <a href="mc.html" title="Next Chapter: Monte Carlo"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Monte Carlo &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">Lumol concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Input file reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../input/index.html">The <code class="docutils literal notranslate"><span class="pre">[input]</span></code> section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../log/index.html">The <code class="docutils literal notranslate"><span class="pre">[log]</span></code> section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../systems/index.html">The <code class="docutils literal notranslate"><span class="pre">[[systems]]</span></code> section</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">The <code class="docutils literal notranslate"><span class="pre">[[simulations]]</span></code> section</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/index.html">Modifying lumol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="molecular-dynamics">
<span id="id1"></span><h1>Molecular dynamics<a class="headerlink" href="#molecular-dynamics" title="Permalink to this headline">¶</a></h1>
<p>A molecular dynamics simulation is started by setting the propagator <code class="docutils literal notranslate"><span class="pre">type</span></code> to
<code class="docutils literal notranslate"><span class="pre">&quot;MolecularDynamics&quot;</span></code>. The only needed key is the <code class="docutils literal notranslate"><span class="pre">timestep</span></code>, which is the
time step to use in the integration of forces and velocities to positions.</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">simulations</span><span class="p">]]</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">1</span><span class="n">_000_000</span>

<span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;BerendsenBarostat&quot;</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="s">&quot;100 bar&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">}</span>
<span class="n">thermostat</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Berendsen&quot;</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;400 K&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">100</span><span class="p">}</span>
</pre></div>
</div>
<p>Other options are the <code class="docutils literal notranslate"><span class="pre">integrator</span></code> key to use another integration scheme, the
<code class="docutils literal notranslate"><span class="pre">thermostat</span></code> key to set a thermostat, and the <code class="docutils literal notranslate"><span class="pre">controls</span></code> key to add some
additional control algorithm to the simulation.</p>
<div class="section" id="integrators">
<h2>Integrators<a class="headerlink" href="#integrators" title="Permalink to this headline">¶</a></h2>
<p>Integrators are algorithms that propagate the forces acting on the particles to
compute their motions. The simplest ones performs an NVE integration, but some
integrators allow to work in different ensembles.  All NVE integrators can be
turned into NVT integrators by adding a <a class="reference internal" href="#md-thermostat"><span class="std std-ref">thermostat</span></a> to the
simulation. In the input, if the <code class="docutils literal notranslate"><span class="pre">integrator</span></code> key is absent, the default
integrator is a Velocity-Verlet integrator.</p>
<div class="section" id="velocity-verlet-integrator">
<h3>Velocity-Verlet integrator<a class="headerlink" href="#velocity-verlet-integrator" title="Permalink to this headline">¶</a></h3>
<p>Velocity-Verlet is the most common NVE integrator for molecular dynamics. See
this <a class="reference external" href="https://en.wikipedia.org/wiki/Verlet_integration#Velocity_Verlet">page</a> for more information about the algorithm.</p>
<p>In the input, it can be specified by using the <code class="docutils literal notranslate"><span class="pre">VelocityVerlet</span></code> integrator
type:</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;VelocityVerlet&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="verlet-integrator">
<h3>Verlet integrator<a class="headerlink" href="#verlet-integrator" title="Permalink to this headline">¶</a></h3>
<p>Verlet algorithm is another simple NVE integrator. See this <a class="reference external" href="https://en.wikipedia.org/wiki/Verlet_integration#Basic_St.C3.B6rmer.E2.80.93Verlet">page</a> for
more information. Most of the time, the Velocity-Verlet algorithm is preferable,
since it produces more precise velocities.</p>
<p>In the input, it can be specified by using the <code class="docutils literal notranslate"><span class="pre">Verlet</span></code> integrator type:</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Verlet&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="leap-frog-integrator">
<h3>Leap-Frog integrator<a class="headerlink" href="#leap-frog-integrator" title="Permalink to this headline">¶</a></h3>
<p>The Leap-Frog algorithm is a third NVE integrator. See this <a class="reference external" href="https://en.wikipedia.org/wiki/Leapfrog_integration">page</a>
for details about the algorithm.</p>
<p>In the input, it can be specified by using the <code class="docutils literal notranslate"><span class="pre">LeapFrog</span></code> integrator type:</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;LeapFrog&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="berendsen-barostat">
<h3>Berendsen barostat<a class="headerlink" href="#berendsen-barostat" title="Permalink to this headline">¶</a></h3>
<p>The Berendsen barostat integrator algorithm use the Berendsen barostat with a
Velocity-Verlet integrator to achieve NPT integration. It must be use together
with a thermostat, preferentially the Berendsen thermostat. See this <a class="reference external" href="http://www.sklogwiki.org/SklogWiki/index.php/Berendsen_barostat">page</a> for more information about the algorithm.</p>
<p>This algorithm exists in two versions: an isotropic one and an anisotropic one.
The isotropic version of the barostat scale all the cell parameter by the same
value using the scalar pressure. The anisotropic version scale the different
cell parameters by different values, using the stress tensor instead.</p>
<p>In the input, the isotropic barostat can be specified by using the
<code class="docutils literal notranslate"><span class="pre">BerendsenBarostat</span></code> integrator type:</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;BerendsenBarostat&quot;</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="s">&quot;100 bar&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">}</span>
<span class="n">thermostat</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Berendsen&quot;</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;400 K&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">100</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pressure</span></code> key specify the target pressure for the simulation, and the
<code class="docutils literal notranslate"><span class="pre">timestep</span></code> is the relaxation time step of the barostat.</p>
<p>The anisotropic version of the Berendsen barostat can be specified by using the
<code class="docutils literal notranslate"><span class="pre">AnisoBerendsenBarostat</span></code> integrator type:</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;AnisoBerendsenBarostat&quot;</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="s">&quot;100 bar&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">}</span>
<span class="n">thermostat</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Berendsen&quot;</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;400 K&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">100</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pressure</span></code> key specify the target hydrostatic pressure for the simulation,
and the <code class="docutils literal notranslate"><span class="pre">timestep</span></code> is the relaxation time step of the barostat.</p>
<p>In both cases, the barostat time step is expressed in fraction of the main
integration time step. Using a main time step of 2 fs and a barostat time step
of 1000 will yield an effective relaxation time of 2000 fs or 2 ps.</p>
</div>
</div>
<div class="section" id="thermostats">
<span id="md-thermostat"></span><h2>Thermostats<a class="headerlink" href="#thermostats" title="Permalink to this headline">¶</a></h2>
<p>Thermostats are algorithms used to maintain the temperature of a system at a
given value. They are specified in the input by the <code class="docutils literal notranslate"><span class="pre">thermostat</span></code> key.</p>
<div class="section" id="berendsen-thermostat">
<h3>Berendsen thermostat<a class="headerlink" href="#berendsen-thermostat" title="Permalink to this headline">¶</a></h3>
<p>The Berendsen thermostat is described <a class="reference external" href="http://www.sklogwiki.org/SklogWiki/index.php/Berendsen_thermostat">here</a>, and
provide a simple exponential relaxation of the temperature to a target value. In
the input, it is declared with the <code class="docutils literal notranslate"><span class="pre">Berendsen</span></code> thermostat type, a target
<code class="docutils literal notranslate"><span class="pre">temperature</span></code> value, and a <code class="docutils literal notranslate"><span class="pre">timestep</span></code>.</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">thermostat</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Berendsen&quot;</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;400 K&quot;</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="mi">100</span><span class="p">}</span>
</pre></div>
</div>
<p>The time step is expressed in fraction of the main integration time step, like
for the Berendsen barostat.</p>
</div>
<div class="section" id="rescaling-thermostat">
<h3>Rescaling thermostat<a class="headerlink" href="#rescaling-thermostat" title="Permalink to this headline">¶</a></h3>
<p>A rescaling thermostat is the simplest thermostat algorithm possible: it just
rescale all the velocities to set the temperature to the wanted value. It can be
useful for equilibration as it converges quickly. In the input, it is specified
by the <code class="docutils literal notranslate"><span class="pre">Rescale</span></code> thermostat type, a target <code class="docutils literal notranslate"><span class="pre">temperature</span></code> value, and a
<code class="docutils literal notranslate"><span class="pre">tolerance</span></code> value. The tolerance value is optional, and is used to let the
system fluctuate around the wanted temperature: while the instant temperature is
inside the <code class="docutils literal notranslate"><span class="pre">[temperature</span> <span class="pre">-</span> <span class="pre">tolerance</span> <span class="pre">:</span> <span class="pre">temperature</span> <span class="pre">+</span> <span class="pre">tolerance]</span></code> range, no
rescale happen.</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">thermostat</span> <span class="o">=</span> <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Rescale&quot;</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;250 K&quot;</span><span class="p">,</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="s">&quot;10 K&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="controls">
<h2>Controls<a class="headerlink" href="#controls" title="Permalink to this headline">¶</a></h2>
<p>Control algorithm are supplementary steps that modify the system to ensure some
invariant, or apply some constraint. They are specified in the <code class="docutils literal notranslate"><span class="pre">controls</span></code>
array, by giving a control <code class="docutils literal notranslate"><span class="pre">type</span></code>. The <code class="docutils literal notranslate"><span class="pre">every</span></code> key specifies that the
algorithm should only be run every <code class="docutils literal notranslate"><span class="pre">n</span></code> step of the simulation (optional,
defaults to 1).</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">simulations</span><span class="p">.</span><span class="n">propagator</span><span class="p">]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MolecularDynamics&quot;</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="s">&quot;1 fs&quot;</span>
<span class="n">controls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Remove global rotation of the system every 4 timestep</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;RemoveRotation&quot;</span><span class="p">,</span> <span class="n">every</span> <span class="o">=</span> <span class="mi">4</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">RemoveTranslation</span></code> control removes the global system rotation;</li>
<li>The <code class="docutils literal notranslate"><span class="pre">RemoveRotation</span></code> control removes the global system translation.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">Rewrap</span></code> control rewraps all molecules’ centers of mass to lie within
the unit cell. Individual atoms in a molecule may still lie outside of the
cell.</li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p class="pull-left">
        &copy; Lumol contributors
    </p>
    <p class="text-center">
        Available on <a href="https://github.com/lumol-org/lumol">Github</a>
    </p>
  </div>
</footer>

  </body>
</html>